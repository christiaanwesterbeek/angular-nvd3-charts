!function(t){"use strict";var e=t.nv;"undefined"!=typeof exports&&(e=require("nvd3")),angular.module("nvd3",[]).directive("nvd3",["nvd3Utils",function(t){return{restrict:"AE",scope:{data:"=",options:"=",api:"=?",events:"=?",config:"=?",onReady:"&?"},link:function(a,n,i){function o(t,e,n){t&&e&&angular.forEach(t,function(i,c){"_"===c[0]||("dispatch"===c?((void 0===e[c]||null===e[c])&&a._config.extended&&(e[c]={}),r(i,e[c])):"tooltip"===c?((void 0===e[c]||null===e[c])&&a._config.extended&&(e[c]={}),o(t[c],e[c],n)):"contentGenerator"===c?e[c]&&t[c](e[c]):-1===["axis","clearHighlights","defined","highlightPoint","nvPointerEventsClass","options","rangeBand","rangeBands","scatter","open","close","node"].indexOf(c)&&(void 0===e[c]||null===e[c]?a._config.extended&&(e[c]=i()):t[c](e[c])))})}function r(t,e){t&&e&&angular.forEach(t,function(n,i){void 0===e[i]||null===e[i]?a._config.extended&&(e[i]=n.on):t.on(i+"._",e[i])})}function c(e){var i=t.deepExtend(d(e),a.options[e]||{});a._config.extended&&(a.options[e]=i);var o=angular.element("<div></div>").html(i.html||"").addClass(e).addClass(i.className).removeAttr("style").css(i.css);i.html||o.text(i.text),i.enable&&("title"===e?n.prepend(o):"subtitle"===e?angular.element(n[0].querySelector(".title")).after(o):"caption"===e&&n.append(o))}function s(){var e=t.deepExtend(l(),a.options.styles||{});a._config.extended&&(a.options.styles=e),angular.forEach(e.classes,function(t,e){t?n.addClass(e):n.removeClass(e)}),n.removeAttr("style").css(e.css)}function d(t){switch(t){case"title":return{enable:!1,text:"Write Your Title",className:"h4",css:{width:a.options.chart.width+"px",textAlign:"center"}};case"subtitle":return{enable:!1,text:"Write Your Subtitle",css:{width:a.options.chart.width+"px",textAlign:"center"}};case"caption":return{enable:!1,text:"Figure 1. Write Your Caption text.",css:{width:a.options.chart.width+"px",textAlign:"center"}}}}function l(){return{classes:{"with-3d-shadow":!0,"with-transitions":!0,gallery:!1},css:{}}}function h(t,e){t!==e&&(a._config.disabled||(a._config.refreshDataOnly?a.api.update():a.api.refresh()))}var u={extended:!1,visible:!0,disabled:!1,refreshDataOnly:!0,deepWatchOptions:!0,deepWatchData:!0,deepWatchDataDepth:2,debounce:10,debounceImmediate:!0};a.isReady=!1,a._config=angular.extend(u,a.config),a.api={refresh:function(){a.api.updateWithOptions(),a.isReady=!0},refreshWithTimeout:function(t){setTimeout(function(){a.api.refresh()},t)},update:function(){a.chart&&a.svg?"sunburstChart"===a.options.chart.type?a.svg.datum(angular.copy(a.data)).call(a.chart):a.svg.datum(a.data).call(a.chart):a.api.refresh()},updateWithTimeout:function(t){setTimeout(function(){a.api.update()},t)},updateWithOptions:function(n){if(arguments.length){if(a.options=n,a._config.deepWatchOptions&&!a._config.disabled)return}else n=a.options;a.api.clearElement(),angular.isDefined(n)!==!1&&a._config.visible&&(a.chart=e.models[n.chart.type](),a.chart.id=Math.random().toString(36).substr(2,15),angular.forEach(a.chart,function(t,e){"_"===e[0]||["clearHighlights","highlightPoint","id","options","resizeHandler","state","open","close","tooltipContent"].indexOf(e)>=0||("dispatch"===e?((void 0===n.chart[e]||null===n.chart[e])&&a._config.extended&&(n.chart[e]={}),r(a.chart[e],n.chart[e])):["bars","bars1","bars2","boxplot","bullet","controls","discretebar","distX","distY","focus","interactiveLayer","legend","lines","lines1","lines2","multibar","pie","scatter","scatters1","scatters2","sparkline","stack1","stack2","sunburst","tooltip","x2Axis","xAxis","y1Axis","y2Axis","y3Axis","y4Axis","yAxis","yAxis1","yAxis2"].indexOf(e)>=0||"stacked"===e&&"stackedAreaChart"===n.chart.type?((void 0===n.chart[e]||null===n.chart[e])&&a._config.extended&&(n.chart[e]={}),o(a.chart[e],n.chart[e],n.chart.type)):"focusHeight"===e&&"lineChart"===n.chart.type||"focusHeight"===e&&"lineWithFocusChart"===n.chart.type||("xTickFormat"!==e&&"yTickFormat"!==e||"lineWithFocusChart"!==n.chart.type)&&("tooltips"===e&&"boxPlotChart"===n.chart.type||("tooltipXContent"!==e&&"tooltipYContent"!==e||"scatterChart"!==n.chart.type)&&("x"!==e&&"y"!==e||"forceDirectedGraph"!==n.chart.type)&&(void 0===n.chart[e]||null===n.chart[e]?a._config.extended&&("barColor"===e?n.chart[e]=t()():n.chart[e]=t()):a.chart[e](n.chart[e]))))}),a.api.updateWithData(),(n.title||a._config.extended)&&c("title"),(n.subtitle||a._config.extended)&&c("subtitle"),(n.caption||a._config.extended)&&c("caption"),(n.styles||a._config.extended)&&s(),e.addGraph(function(){return a.chart?(a.chart.resizeHandler&&a.chart.resizeHandler.clear(),a.chart.resizeHandler=e.utils.windowResize(function(){a.chart&&a.chart.update&&a.chart.update()}),void 0!==n.chart.zoom&&["scatterChart","lineChart","candlestickBarChart","cumulativeLineChart","historicalBarChart","ohlcBarChart","stackedAreaChart"].indexOf(n.chart.type)>-1&&t.zoom(a,n),a.chart):void 0},n.chart.callback))},updateWithData:function(t){if(arguments.length){if(a.data=t,a._config.deepWatchData&&!a._config.disabled)return}else t="sunburstChart"===a.options.chart.type?angular.copy(a.data):a.data;if(t){d3.select(n[0]).select("svg").remove();var e,i;a.svg=d3.select(n[0]).insert("svg",".caption"),(e=a.options.chart.height)&&(isNaN(+e)||(e+="px"),a.svg.attr("height",e).style({height:e})),(i=a.options.chart.width)?(isNaN(+i)||(i+="px"),a.svg.attr("width",i).style({width:i})):a.svg.attr("width","100%").style({width:"100%"}),a.svg.datum(t).call(a.chart),a.chart&&a.chart.zoomRender&&a.chart.zoomRender()}},clearElement:function(){if(n.find(".title").remove(),n.find(".subtitle").remove(),n.find(".caption").remove(),n.empty(),a.chart&&a.chart.tooltip&&a.chart.tooltip.id&&d3.select("#"+a.chart.tooltip.id()).remove(),a.chart&&a.chart.interactiveLayer&&a.chart.interactiveLayer.tooltip&&a.chart.interactiveLayer.tooltip.id&&d3.select("#"+a.chart.interactiveLayer.tooltip.id()).remove(),e.graphs&&a.chart)for(var t=e.graphs.length-1;t>=0;t--)e.graphs[t]&&e.graphs[t].id===a.chart.id&&e.graphs.splice(t,1);e.tooltip&&e.tooltip.cleanup&&e.tooltip.cleanup(),a.chart&&a.chart.resizeHandler&&a.chart.resizeHandler.clear(),a.chart=null},getScope:function(){return a},getElement:function(){return n}},a._config.deepWatchOptions&&a.$watch("options",t.debounce(function(t){a._config.disabled||a.api.refresh()},a._config.debounce,a._config.debounceImmediate),!0),a._config.deepWatchData&&(1===a._config.deepWatchDataDepth?a.$watchCollection("data",h):a.$watch("data",h,2===a._config.deepWatchDataDepth)),a.$watch("config",function(t,e){t!==e&&(a._config=angular.extend(u,t),a.api.refresh())},!0),a._config.deepWatchOptions||a._config.deepWatchData||a.api.refresh(),angular.forEach(a.events,function(t,e){a.$on(e,function(e,n){return t(e,a,n)})}),n.on("$destroy",function(){a.api.clearElement()}),a.$watch("isReady",function(t){t&&a.onReady&&"function"==typeof a.onReady()&&a.onReady()(a,n)})}}}]).factory("nvd3Utils",function(){return{debounce:function(t,e,a){var n;return function(){var i=this,o=arguments,r=function(){n=null,a||t.apply(i,o)},c=a&&!n;clearTimeout(n),n=setTimeout(r,e),c&&t.apply(i,o)}},deepExtend:function(t){var e=this;return angular.forEach(arguments,function(a){a!==t&&angular.forEach(a,function(a,n){t[n]&&t[n].constructor&&t[n].constructor===Object?e.deepExtend(t[n],a):t[n]=a})}),t},zoom:function(t,e){var a=e.chart.zoom,n="undefined"==typeof a.enabled||null===a.enabled?!0:a.enabled;if(n){var i,o,r,c,s,d=t.chart.xAxis.scale(),l=t.chart.yAxis.scale(),h=t.chart.xDomain||d.domain,u=t.chart.yDomain||l.domain,p=d.domain().slice(),f=l.domain().slice(),g=a.scale||1,m=a.translate||[0,0],v=a.scaleExtent||[1,10],x=a.useFixedDomain||!1,y=a.useNiceScale||!1,b=a.horizontalOff||!1,_=a.verticalOff||!1,z=a.unzoomEventType||"dblclick.zoom";y&&(d.nice(),l.nice()),i=function(t,e){return t[0]=Math.min(Math.max(t[0],e[0]),e[1]-e[1]/v[1]),t[1]=Math.max(e[0]+e[1]/v[1],Math.min(t[1],e[1])),t},r=function(){if(void 0!==a.zoomed){var e=a.zoomed(d.domain(),l.domain());b||h([e.x1,e.x2]),_||u([e.y1,e.y2])}else b||h(x?i(d.domain(),p):d.domain()),_||u(x?i(l.domain(),f):l.domain());t.chart&&t.chart.update()},c=function(){if(void 0!==a.unzoomed){var e=a.unzoomed(d.domain(),l.domain());b||h([e.x1,e.x2]),_||u([e.y1,e.y2])}else b||h(p),_||u(f);o.scale(g).translate(m),t.chart&&t.chart.update()},s=function(){void 0!==a.zoomend&&a.zoomend()},o=d3.behavior.zoom().x(d).y(l).scaleExtent(v).on("zoom",r).on("zoomend",s),t.svg&&(t.svg.call(o),o.scale(g).translate(m).event(t.svg),"none"!==z&&t.svg.on(z,c)),t.chart&&(t.chart.zoomRender=function(){o.scale(g).translate(m),d=t.chart.xAxis.scale(),l=t.chart.yAxis.scale(),h=t.chart.xDomain||d.domain,u=t.chart.yDomain||l.domain,p=d.domain().slice(),f=l.domain().slice(),o.x(d).y(l),t.svg.call(o),"none"!==z&&t.svg.on(z,c)})}}}})}(window);
